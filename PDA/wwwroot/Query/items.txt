SELECT 
    INVOICE_CHARGE_V.LINE_AMOUNT, 
    (INVOICE_CHARGE_V.TOTAL_UNIT) AS QTY, 
    (INVOICE_CHARGE_V.UNIT_RATE * INVOICE_CHARGE_V.EXCHANGE_RATE * COALESCE(INVOICE_CHARGE_V.TOTAL_UNIT2, 1)) AS RATE, 
    COALESCE(INVOICE_CHARGE_V.CHARGE_LINE_DS2, 
    INVOICE_CHARGE_V.CHARGE_LINE_DS) AS CHARGE_LINE_DSC ,
    case when PAYMENT_STATUS_CODE = 'SETTLED' then 1 else 0 end as is_settled
FROM 
    EBS_OWNER.INVOICE_V@ZDCDB , 
    EBS_OWNER.INVOICE_CHARGE_V@ZDCDB ,
    DQV_INVOICE_HEADER@ZDCDB Hed
WHERE 
    INVOICE_V.INVOICE_ID = INVOICE_CHARGE_V.INVOICE_ID 
    AND INVOICE_CHARGE_V.LINE_AMOUNT > 0  
    AND INVOICE_AN = :invoiceNbr
    and INVOICE_AN = Hed.Invoice_nbr
